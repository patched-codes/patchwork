# `patchwork/steps/CallShell` Module Documentation

## Overview

The `CallShell` module is a part of the Patchwork framework that allows for executing shell scripts as a step within a larger workflow. This module is especially useful for users who need to integrate shell commands or scripts within a Python-based workflow, providing both flexibility and ease of use. It involves executing a shell script and capturing its standard output and error messages.

## Files and Descriptions

### 1. `CallShell.py`

This file contains the main functionality for the `CallShell` class, which inherits from the `Step` class provided by Patchwork. It is responsible for executing shell scripts with optional environment variables and can handle script templates with values.

### 2. `__init__.py`

This is an empty file meant to designate the `CallShell` directory as a Python package, allowing for module imports.

### 3. `typed.py`

This file defines typed dictionaries for inputs and outputs, used to type-check and validate the data passed to the `CallShell` class.

---

## `CallShell.py`

### Inputs

The `CallShell` class expects inputs that are defined via the `CallShellInputs` typed dictionary:

- **script**: A string containing the shell script to execute.
- **working_dir** (optional): Specifies the directory to execute the script from. Defaults to the current working directory.
- **env** (optional): A string of environment variables in the form of key-value pairs separated by semicolons.
- **script_template_values** (optional): A dictionary of values to be rendered into the script using `mustache` templates.

### Outputs

The outputs of the `CallShell` execution are captured as defined by the `CallShellOutputs` typed dictionary:

- **stdout_output**: Standard output generated by the script execution.
- **stderr_output**: Standard error output generated by the script execution.

### Usage

To use the `CallShell` class, instantiate it with the necessary script and input settings. Call the `run` method to execute the script and capture the outputs. It is useful in workflows where integration with shell scripts or system commands is required.

#### Example

```python
inputs = {
    'script': 'echo "Hello, World!"',
    'working_dir': '/path/to/dir',
    'env': 'VAR1=value1;VAR2=value2',
    'script_template_values': {}
}

callshell_step = CallShell(inputs)
outputs = callshell_step.run()
print(outputs['stdout_output'])
```

This example runs a simple script that prints "Hello, World!" to the standard output.

## `typed.py`

### Input Class - `CallShellInputs`

- **script**: Mandatory. The script to run.
- **working_dir**: Optional. The script's working directory.
- **env**: Optional. Additional environment variables.
- **script_template_values**: Optional. Values for script rendering.

### Output Class - `CallShellOutputs`

- **stdout_output**: Captured standard output.
- **stderr_output**: Captured standard error output.

---

This documentation provides an overview of the `patchwork/steps/CallShell` module, detailing its purpose, usage, and the types of inputs and outputs it handles. This should assist developers in integrating shell script execution into their workflows using the Patchwork framework.
